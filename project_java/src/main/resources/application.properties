# =====================================================
# = PROJECT
# =====================================================
spring.application.name=project_java
server.port=${SERVER_PORT:8080}

# =====================================================
# = DATASOURCE (LOCAL)
#   Mặc định dùng user evcs/evcs123.
# =====================================================
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/evcs?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Ho_Chi_Minh
spring.datasource.username=${DB_USERNAME:evcs}
spring.datasource.password=${DB_PASSWORD:evcs123}

# =====================================================
# = JPA / HIBERNATE
#   validate: kiểm tra schema đúng file Flyway
#   open-in-view=false: tránh lazy-load ở layer web
#   JDBC time_zone=UTC: chuẩn hoá thời gian lưu DB
# =====================================================
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# =====================================================
# = FLYWAY
# =====================================================
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=false
spring.flyway.validate-on-migrate=true
spring.flyway.clean-disabled=true

# =====================================================
# = LOGGING
# =====================================================
logging.level.root=INFO
# logging.level.org.hibernate.SQL=DEBUG
# logging.level.org.hibernate.type.descriptor.sql=TRACE
# logging.level.org.flywaydb=DEBUG

# =====================================================
# = OPENAPI / SWAGGER
#   UI: http://localhost:${server.port}/swagger-ui/index.html
# =====================================================
springdoc.api-docs.enabled=true
springdoc.swagger-ui.path=/swagger-ui

# =====================================================
# = JSON / TIMEZONE
# =====================================================
spring.jackson.time-zone=Asia/Ho_Chi_Minh
spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss
spring.jackson.serialization.fail-on-empty-beans=false

# =====================================================
# = JWT (HS256)
#   SECRET >= 32 bytes. Ở PROD nạp bằng biến môi trường APP_JWT_SECRET.
#   TTL: tuỳ service đọc seconds hay minutes.
# =====================================================
app.jwt.secret=${APP_JWT_SECRET:CHANGE_ME_32+_CHARS_MINIMUM_RANDOM}
app.jwt.access-ttl-minutes=15
app.jwt.refresh-ttl-days=14

# =====================================================
# = REFRESH COOKIE (LOCAL HTTP)
#   Local: Secure=false, SameSite=Lax, Domain=localhost
#   PROD HTTPS: xem ghi chú bên dưới
# =====================================================
app.jwt.refresh-cookie-name=refresh_token
app.jwt.refresh-cookie-domain=localhost
app.jwt.refresh-cookie-secure=false
app.jwt.refresh-cookie-samesite=Lax

# =====================================================
# = REVERSE PROXY (BẬT khi deploy sau Nginx/ALB HTTPS)
# =====================================================
# server.forward-headers-strategy=framework

# ==== Money / VAT ====
app.vat.percent=8
app.money.rounding-mode=HALF_UP

# ==== Realtime (SSE) ====
app.realtime.mode=sse

# ==== Files ====
app.files.base-dir=uploads
app.files.invoice-dir=${app.files.base-dir}/invoices

